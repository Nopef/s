<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>PoC Media</title>
</head>
<body>
    <video controls id="output"></video>

    <script>
      // stream capture
      const constraints = {
        video: {
             mandatory: {
                chromeMediaSource: 'desktop',
                minWidth: 1280,
                maxWidth: 1280,
                minHeight: 720,
		maxHeight: 720
             },
         },
      };
      // const constraints = {audio: false,  video: true}; // video capture
      // const constraints = {audio: true,  video: false};  // audio capture

      navigator.getUserMedia(constraints, (stream) => {
        const mediaRecorder = new MediaRecorder(stream);

        mediaRecorder.start();

        mediaRecorder.ondataavailable = (e) => {
          const reader = new FileReader();

          reader.readAsDataURL(e.data);
          reader.onloadend = () => {
            const base64data = reader.result;
	    document.getElementById('output').src = base64data.replace('video/x-matroska', 'video/mp4'); // replace mime for chrome's tag video
            // do anything with stream here            
          }
        }

        setTimeout(() => {
          mediaRecorder.stop();
        }, 3000); // autostop record
      }, (err) => {console.log(err) });
    </script>
</body>
</html>
